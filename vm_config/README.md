# Virtual machines configuration
   * [VMware configuration](#vmware-configuration)
      * [Creating a VM](#creating-a-vm)
      * [Configuring the VM](#configuring-the-vm)
   * [Kali configuration](#kali-configuration)
      * [Updating Kali](#updating-kali)
      * [Increasing display blanking timeout](#increasing-display-blanking-timeout)
      * [Setting scaling](#setting-scaling)
      * [Configuring panel](#configuring-panel)
      * [Configuring terminal](#configuring-terminal)
      * [Configuring Firefox](#configuring-firefox)
      * [Permitting root login](#permitting-root-login)
   * [Installing and configuring useful tools](#installing-and-configuring-useful-tools)

## VMware configuration
### Creating a VM
- Download the official Kali Linux image.
- Create a new virtual machine from the ISO file.
- Select _Linux Debian 10 x64_ OS.
- Select UEFI Bios.

### Configuring the VM
- 8GB RAM.
- 2 CPU cores.
- 40GB hard disk.
- Bridged networking.
- Accelerated graphics, 2+ GB video memory, and full retina resolution.
- Use Mac keyboard profile as default.
- Disable Bluetooth devices.
- Disable share folders.
- Disable printers.
- Remove camera.
- Synchronize time and pass power status.

## Kali configuration
### Updating Kali
```bash
sudo apt update
sudo apt full-upgrade -y
```

### Increasing display blanking timeout
- Settings -> Power Management -> Display
- Increase display blanking timeout for both _Plugged In_ and _On Battery_ modes.

### Setting scaling
- Set HiDPI Mode _(Applications -> Kali HiDPI Mode)_
- Set Terminal Font _(Hack, 14)_
- Set Burp font size 15.

### Configuring panel
- Lock it on the bottom of the screen.
- Move _Show Desktop_ to the far right corner.
- Remove _Lock Screen_ from _Action Buttons_.
- Remove _Workspace Switcher_.
- Add Quick Use items in this order:
	- _Directory Menu_.
	- _Firefox_.
	- _Burpsuite_.
	- _Terminal Emulator_.

### Configuring terminal
- Behavior -> Unlimited History
- Behavior -> Open new terminals in current working directory.

### Configuring Firefox
- Go to `about:config`
- Set `browser.urlbar.trimURLs` to `false`

### Permitting `root` login
- Allow `root` login:
```bash
sudo nano /etc/ssh/sshd_config # Set PermitRootLogin yes
sudo service ssh restart
```
- Set password for the `root` user:
```bash
sudo passwd root
```

## Installing and configuring useful tools
- Open terminal and change to the `~/Download` folder.
- Login to Github and add ssh keys:
```bash
ssh-keygen -t ed25519 -C "<email>"
eval "$(ssh-agent -s)"
ssh-add ~/.ssh/id_ed25519
cat ~/.ssh/id_ed25519.pub
```
- Clone _pentesting-tools_ repo (`git clone git@github.com:mchern1kov/pentesting-tools.git ~/pentesting-tools`)
- Prepare rockyou.txt:
```bash
sudo gzip -dk /usr/share/wordlists/rockyou.txt.gz # Decompress
sudo sed -i '/^\s*$/d' /usr/share/wordlists/rockyou.txt # Remove empty lines
```
- Setting Samba min version:
```bash
sudo nano /etc/samba/smb.conf

[global]
client min protocol = NT1
```
- Setting TLS min version:
```bash
sudo sed -i -E 's/MinProtocol[=\ ]+.*/MinProtocol = TLSv1.0/g' /etc/ssl/openssl.cnf
```
- Configure snmp:
```bash
sudo apt install snmp-mibs-downloader -y
sudo download-mibs
sudo nano /etc/snmp/snmp.conf # Comment "mibs:" line
```
- Sublime Text _(https://www.sublimetext.com/docs/linux_repositories.html#apt)_. Add configuration:
```json
	"dictionary": "Packages/Language - English/en_US.dic",
	"spell_check": true
```
- Apache OpenOffice: https://www.openoffice.org/download/index.html:
```bash
tar -xvzf Apache_OpenOffice*
sudo dpkg -i ./en-US/DEBS/openoffice*
sudo dpkg -i ./en-US/DEBS/desktop-integration/openoffice*
```
- Obsidian: https://obsidian.md/download _(two additional packages required: https://pkgs.org/download/libindicator3-7, https://pkgs.org/download/libappindicator3-1)_:
```bash
sudo dpkg -i libindicator3-7*.deb
sudo dpkg -i libappindicator3-1*.deb
sudo dpkg -i obsidian*.deb
```
- Burp CA _(go to 127.0.0.1:8080)_.
- FoxyProxy plugin for the Firefox _(add  127.0.0.1:8080 Burp proxy)_.
- Wappalyzer plugin for the Firefox.
- Python3 pip (`sudo apt install python3-pip -y`).
- Python2 pip:
```bash
wget https://bootstrap.pypa.io/pip/2.7/get-pip.py
sudo python get-pip.py
```
- Python devtools:
```bash
sudo apt install python-dev -y
sudo apt install python3-dev -y
```
- Python setup tools (`sudo apt install python-setuptools -y`).
- npm (`sudo apt install npm -y`).
- snap:
```
sudo apt install snapd # Restart required
sudo systemctl enable snapd.service
sudo systemctl enable apparmor.service
sudo snap install core
sudo nano /etc/environment # Add /snap/bin to path
```
- Insomnia REST (`sudo snap install insomnia`)
- golang (`sudo apt install golang -y`).
- feroxbuster: (`sudo apt install feroxbuster -y`).
- fpm (`sudo gem install --no-document fpm`).
- rlwrap (`sudo apt install rlwrap -y`).
- mysql-client (`sudo apt install default-mysql-client -y`).
- mysql-shell (`sudo snap install mysql-shell`).
- mssql-cli (`sudo python3 -m pip install mssql-cli`).
- redis-tools (`sudo apt install redis-tools -y`).
- jwt-cracker (`sudo npm install --global jwt-cracker`).
- droopescan (`sudo pip3 install droopescan`).
- cross-compilation tools:
```bash
sudo dpkg --add-architecture i386
sudo apt-get update
sudo apt install gcc-mingw-w64 -y
sudo apt install g++-mingw-w64 -y
sudo apt install mingw-w64 -y
sudo apt install gcc-multilib
sudo apt install g++-multilib
sudo apt install libc6-dev:i386
```
- cmake (`sudo apt install cmake -y`).
- wes.py:
```bash
wget https://github.com/bitsadmin/wesng/archive/master.zip
unzip master.zip
cd wesng-master
sudo pip3 install .
```
- Impacket:
```bash
wget https://github.com/SecureAuthCorp/impacket/releases/download/impacket_0_9_23/impacket-0.9.23.tar.gz
tar -xzf impacket-*
cd impacket-0.9.23
sudo pip3 install .
```
- evil-winrm (`sudo gem install evil-winrm`).
- pyftpdlib (`sudo pip3 install pyftpdlib`).
- highline (`sudo gem install highline`)
- xls2csv:
```bash
sudo npm install --global xls2csv
sudo npm install --global xlsx2csv
```
- doc2txt:
```bash
sudo npm install --global doc2txt
sudo npm install --global docx2txt
```
- alien (`sudo apt install alien -y`)
- sqlplus _(https://www.oracle.com/database/technologies/instant-client/linux-x86-64-downloads.html)_:
```bash
sudo alien -i oracle-instantclient-basic*.rpm
sudo alien -i oracle-instantclient-sqlplus*.rpm
sudo alien -i oracle-instantclient-devel*.rpm
sudo touch /etc/ld.so.conf.d/oracle.conf
sudo ldconfig
```
- odat:
```bash
wget https://github.com/quentinhardy/odat/releases/download/5.1/odat-linux-libc2.12-x86_64.tar.gz
sudo mkdir /opt/odat
sudo tar -xzf odat-linux-libc2.12-x86_64.tar.gz -C /opt
sudo mv /opt/odat-libc2.12-x86_64 /opt/odat

nano ~/.zshrc
function odat () {
    #export LD_LIBRARY_PATH=/opt/odat/
    (cd /opt/odat/ && ./odat-libc2.12-x86_64 "$@")
}
source ~/.zshrc
sudo chmod 777 /opt/odat # Required by some functions
```
- oletools (`sudo -H pip3 install oletools`).
- MongoDB cli. _(https://www.mongodb.com/download-center/community/releases Debian 10.0 shell version)_ and install:
```bash
sudo dpkg -i ./mongodb*.deb
```
